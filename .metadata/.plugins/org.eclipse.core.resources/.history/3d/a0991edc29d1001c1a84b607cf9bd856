/*
 * Avion.c
 *
 *  Created on: 11 may. 2022
 *      Author: juanm
 */
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

int inicializarAvion(eAvion vec[], int tam)
{
    int todoOk = 0;
    if(vec != NULL && tam > 0)
    {
        for(int i=0; i < tam; i++)
        {
            vec[i].isEmpty = 1;
        }
        todoOk = 1;
    }
    return todoOk;
}




int buscarAvionLibre(eAvion vec[], int tam, int* pIndex)
{
    int todoOk = 0;
    if(vec != NULL && tam > 0 && pIndex != NULL)
    {
        *pIndex = -1;
        for(int i=0; i < tam; i++)
        {
            if( vec[i].isEmpty )
            {
                *pIndex = i;
                break;
            }
        }
        todoOk = 1;
    }
    return todoOk;
}
int buscarAvion(eAvion vec[], int tam,int id, int* pIndex)
{
	int todoOk=-0;
	    if(vec != NULL && tam>0 && pIndex != NULL && id > 0)
		{
	    	*pIndex=-1;
			for(int i=0;i<tam;i++)
			{
				if(vec[i].isEmpty == 0 && vec[i].id == id)
				{
					*pIndex=i;
					break;
				}
			}
			todoOk=1;
		}
		return todoOk;
}
int altaAvion(eAvion vec[], int tam,eTipo tipos[], int tamt,eAerolinea aerolineas[] ,int tamae, int* pLegajo)
{
    int todoOk = 0;
    int indice;
    char auxChar[20];
    eAvion nuevoAuto;


    if(vec != NULL && tam > 0 && pLegajo != NULL)
    {
        if( buscarAutoLibre(vec, tam, &indice) )
        {

            if(indice == - 1)
            {
                printf("No hay lugar en el sistema\n");
            }
            else
            {
                // aca caigo cuando haya lugar

            	listarAerolinea(aerolineas, tamae);

                printf("Ingrese el id de la Aerolinea: ");
                fflush(stdin);
                scanf("%d", &nuevoAuto.idAerolinea);

                while(nuevoAuto.idAerolinea <= 5000 && nuevoAuto.idAerolinea >= 5004)
                {
                    printf("No exite el id de la Aerolinea. Reingrese el id: ");
                    scanf("%d", &nuevoAuto.idAerolinea);
                }

                listarTipo(tipos, tamt);

                printf("Ingrese el id del tipo de vuelo: ");
                fflush(stdin);
                scanf("%d", &nuevoAuto.idTipo);

                while( nuevoAuto.idTipo <= 1000 &&  nuevoAuto.idTipo >= 1004)
                {
                    printf("No exite el id del tipo de vuelo. Reingrese el id: ");
                    scanf("%d", & nuevoAuto.idTipo);
                }

                nuevoAuto.isEmpty = 0;
                nuevoAuto.id = *pLegajo;
                *pLegajo = *pLegajo + 1;
                vec[indice] = nuevoAuto;
                todoOk = 1;
            }
        }
        else
        {
            printf("Ocurrio un problema con los parametros\n");
        }
    }
    return todoOk;
}

int modificarAvion(eAvion vec[],int tam)
{
	int todoOk=0;
	int indice;
	int id;
	char salir;
	if(vec != NULL && tam>0)
	{
		listarAuto(vec, tam);
		printf("ingrese id:\n");
		scanf("%d", &id);
	   	if(buscarAutos(vec, tam, id, &indice))
	   	{
			 if(indice==-1)
	   		 {
	   			  printf("no hay un empleado con legajo %d\n", id);
			 }
	   		 else
		     {
	   			 mostrarAuto(vec[indice]);

	   			do
	   			{
	   				switch(opcionesCambio())
	   				{
	   				case 1:
					printf("%d \n", vec[indice].idColor);

					printf("ingrese su nuevo color:\n");
					fflush(stdin);
					scanf("%d", &vec[indice].idColor);
					while(vec[indice].idColor >= 5000 || vec[indice].idColor < 5004)
					{
						printf("id del color inexicistente. Reingrese id:\n ");
	   		            fflush(stdin);
	   		         scanf("%d", &vec[indice].idColor);
					}
					printf("%d nuevo id de color es \n", vec[indice].idColor);
					break;
	   				case 2:
	   				printf("%d \n", vec[indice].idMarca);

	   				printf("Ingrese el nuevo id de marca:\n ");
	   				fflush(stdin);
	   				scanf("%d", &vec[indice].idMarca);

	   				while(vec[indice].idMarca > 1000 || vec[indice].idMarca < 1004)
	   			    {
	   					printf("Id de marca inexicistente. Reingrese id de marca:\n ");
	   					fflush(stdin);
	   					scanf("%d", &vec[indice].idMarca);
	   			    }
	   			   printf("%d id de la marca es \n", vec[indice].idMarca);
	   			   break;
	   			   case 3:
	   				   confirmarSalida(&salir);
	   			   break;
	   			   default:
	   					printf("opcion Invalida!\n\n");
	   		      }
	   	        system("pause");
	          }while(salir != 's');
	     }
      }
	  else
	  {
			printf("Ocurrio un problema\n");
      }
    todoOk=1;
    }
 return todoOk;
}



























void mostrarAvion(eAvion e)
{

    printf("%d      %d      %d\n", e.id, e.idAerolinea, e.idTipo);

}


int listarAvion(eAvion vec[], int tam)
{
    int todoOk = 0;
    if(vec != NULL && tam > 0)
    {
        //system("cls");
        printf("          *** Listado de Aviones ***\n\n");
        printf("id    idAereolinea    idTipo    \n");
        printf("-----------------------------------------------------\n");
        for(int i=0; i < tam; i++)
        {
        	if(!vec[i].isEmpty)
        	{
        		mostrarAuto(vec[i]);
        	}
        }
        printf("\n\n");

        todoOk = 1;
    }
    return todoOk;
}


